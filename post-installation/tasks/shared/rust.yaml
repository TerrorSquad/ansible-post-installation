---
- name: Install Rust tools
  ansible.builtin.shell:
    cmd: |
      set -o pipefail
      curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
    executable: "{% if ansible_os_family == 'Darwin' %}/bin/bash{% else %}/usr/bin/bash{% endif %}"
  become_user: "{{ username }}"
  become: true
  register: rust_install
  changed_when: rust_install.rc == 0

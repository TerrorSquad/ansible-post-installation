---
- name: Install apt apps (Linux only)
  ansible.builtin.apt:
    name: "{{ item }}"
    state: present
  retries: 3
  delay: 2
  loop: "{{ package_lists.dev_essentials + ['libutempter0', 'python3-pip'] }}"
  when: ansible_os_family == 'Debian'

- name: Install macOS equivalents via Homebrew
  community.general.homebrew:
    name: "{{ item }}"
    state: present
    path: "{{ homebrew_path }}"
  retries: 3
  become: false
  failed_when: false
  register: dev_essentials_result
  loop: "{{ package_lists.dev_essentials }}"
  when: ansible_os_family == 'Darwin'

- name: Install Python via Homebrew (macOS)
  community.general.homebrew:
    name: python
    state: present
    path: "{{ homebrew_path }}"
  retries: 3
  become: false
  when: ansible_os_family == 'Darwin'

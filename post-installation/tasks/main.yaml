---
# ==============================================================================
# GRIFFIN: Cross-Platform Post-Installation Automation
# ==============================================================================

# Detect WSL environment
- name: Detect if running on WSL
  ansible.builtin.set_fact:
    is_wsl: "{{ 'microsoft' in ansible_kernel | lower or 'wsl' in ansible_kernel | lower }}"

# Phase 1: System Preparation
- name: System preparation and basic setup
  ansible.builtin.include_tasks: "{{ ansible_os_family | lower }}/system_setup.yaml"

# Phase 2: Package Managers and Core Tools
- name: Package managers and essential tools
  ansible.builtin.include_tasks: "{{ ansible_os_family | lower }}/core_tools.yaml"

# Phase 3: Development Environment Foundation
- name: Shell and terminal configuration
  ansible.builtin.include_tasks: shared/shell_environment.yaml

- name: Version control and editors
  ansible.builtin.include_tasks: shared/development_foundation.yaml

# Phase 4: Programming Languages (Optional)
- name: Programming language environments
  ansible.builtin.include_tasks: shared/programming_languages.yaml
  when: (rust | bool) or (golang | bool) or (java | bool) or (all | bool)

# Phase 5: Development Tools and Containers
- name: Development tools and containerization
  ansible.builtin.include_tasks: shared/development_tools.yaml

# Phase 6: GUI Applications (Optional)
- name: GUI applications and tools
  ansible.builtin.include_tasks: "{{ ansible_os_family | lower }}/gui_applications.yaml"
  when: (gui | bool) or (dev_tools_gui | bool) or (all | bool)

# Phase 7: System Customization (Platform-specific)
- name: Platform-specific customization
  ansible.builtin.include_tasks: "{{ ansible_os_family | lower }}/system_customization.yaml"
  when: ansible_os_family == 'Debian'

# Phase 8: Cleanup and Finalization
- name: Cleanup and finalization
  ansible.builtin.include_tasks: shared/finalization.yaml

- name: Display completion message
  ansible.builtin.debug:
    msg:
      - "ðŸŽ‰ Griffin installation complete!"
      - "Please restart your machine to ensure all changes take effect."
      - "Check the documentation at: https://terrorsquad.github.io/ansible-post-installation/"
